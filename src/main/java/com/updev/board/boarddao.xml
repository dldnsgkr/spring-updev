<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.updev.board.ServiceBoard">

   <insert id="writesave">
   insert into board(b_num,b_cate,b_kind,b_title,m_nick,b_content,b_likecnt,b_readcnt,b_group,b_step,b_indent,b_tag,b_file1,b_file2,b_report) values(b_seq.nextval,#{param1},#{param2},#{param3},#{param4},#{param5},0,0,b_seq.currval,0,0,#{param6},#{param7},#{param8},0)
   </insert>

	<select id="mewrite" resultType="com.updev.board.Board">
		SELECT * FROM board where m_nick = #{param1}
	</select>
	
	<select id="updatecheck" resultType="com.updev.board.Board">
		SELECT * FROM board where b_num = #{param1}
	</select>
	
	<update id="boardupdate">
		update board set b_cate = #{param2}, b_kind = #{param3}, b_title = #{param4}, b_content = #{param5}, b_tag = #{param6}, b_file1 = #{param7}, b_file2 = #{param8} where b_num = #{param1}
	</update>
	
	<select id="bo1" resultType="com.updev.board.Board">
		select * from board where b_kind = #{param1}
	</select>
	
	<select id="bo2" resultType="com.updev.board.Board">
		select * from board where b_kind = #{param1}
	</select>
	
	<select id="bo3" resultType="com.updev.board.Board">
		select * from board where b_kind = #{param1}
	</select>
	
	<select id="bo4" resultType="com.updev.board.Board">
		select * from board where b_kind = #{param1}
	</select>
	
	<select id="bo5" resultType="com.updev.board.Board">
		select * from board where b_kind = #{param1}
	</select>
	
	<select id="noticeboardtable" resultType="com.updev.board.Board">
		select * from board where b_kind = #{param1}
	</select>
	
	<select id="shareboardtable" resultType="com.updev.board.Board">
		select * from board where b_kind = #{param1}
	</select>
	
	<select id="questionboardtable" resultType="com.updev.board.Board">
		select * from board where b_kind = #{param1}
	</select>
	
	<select id="worryboardtable" resultType="com.updev.board.Board">
		select * from board where b_kind = #{param1}
	</select>
	
	<select id="qnaboardtable" resultType="com.updev.board.Board">
		select * from board where b_kind = #{param1}
	</select>
	
	<delete id="delete">
		delete from board where b_num = #{param1}
	</delete>
	
	<select id="boarddetail" resultType="com.updev.board.Board">
		select * from board where b_num = #{param1}
	</select>
	 
	<update id="readcnt">
		update board set b_readcnt=b_readcnt+1 where b_num=#{param1}
	</update>
	
	<update id="reportboardupdate">
		update board set b_report=b_report+1 where b_num=#{param1}
	</update>
	
	<!-- 좋아요 -->
	<insert id="blikeup">
		insert into good(g_num,b_num,m_nick,like_chk) values(g_seq.nextval,#{param1},#{param2},#{param3})
	</insert>
	
	<select id="howgood" resultType="com.updev.board.Good">
		select * from good where b_num = #{param1} and m_nick = #{param2}
	</select>
	
	<delete id="blikedown">
		delete from good where b_num = #{param1} and m_nick = #{param2}
	</delete>
	
	
	<!-- 페이징 -->
	<select id="sharetotal" resultType="int">
		select count(*) from board where b_kind='정보'
	</select>
	
	<select id="sharepage" resultType="com.updev.board.Board">
		select * from (
		select rownum rn,A.* from(
		select * from board where b_kind='정보' 
		order by b_group DESC,b_step ASC)A)
		where rn between #{start} and #{end}
	</select>
	
	<select id="questiontotal" resultType="int">
		select count(*) from board where b_kind='질문'
	</select>
	
	<select id="questionpage" resultType="com.updev.board.Board">
		select * from (
		select rownum rn,A.* from(
		select * from board where b_kind='질문'
		order by b_group DESC,b_step ASC)A)
		where rn between #{start} and #{end}
	</select>
	
	<select id="worrytotal" resultType="int">
		select count(*) from board where b_kind='고민'
	</select>
	
	<select id="worrypage" resultType="com.updev.board.Board">
		select * from (
		select rownum rn,A.* from(
		select * from board where b_kind='고민' 
		order by b_group DESC,b_step ASC)A)
		where rn between #{start} and #{end}
	</select>
	
	<select id="qnatotal" resultType="int">
		select count(*) from board where b_kind='QNA'
	</select>
	
	<select id="qnapage" resultType="com.updev.board.Board">
		select * from (
		select rownum rn,A.* from(
		select * from board where b_kind='QNA' 
		order by b_group DESC,b_step ASC)A)
		where rn between #{start} and #{end}
	</select>
	
	<select id="noticetotal" resultType="int">
		select count(*) from board where b_kind='공지'
	</select>
	
	<select id="noticepage" resultType="com.updev.board.Board">
		select * from (
		select rownum rn,A.* from(
		select * from board where b_kind='공지' 
		order by b_group DESC,b_step ASC)A)
		where rn between #{start} and #{end}
	</select>
	
	<select id="poptotal" resultType="int">
		select count(*) from board where <![CDATA[b_readcnt > 9]]> and <![CDATA[b_wdate>=TO_CHAR(sysdate-7,'YYYYMMDD')]]>
	</select>
	
	<select id="poppage" resultType="com.updev.board.Board">
		select * from (
		select rownum rn,A.* from(
		select * from board where <![CDATA[b_readcnt > 9]]> and <![CDATA[b_wdate>=TO_CHAR(sysdate-7,'YYYYMMDD')]]>
		order by b_readcnt DESC)A)
		where rn between #{start} and #{end}
	</select>
	
	<select id="searchcnt" resultType="int">
		select count(*) from board where b_title like '%'||#{keyword}||'%' or b_content like '%'||#{keyword}||'%'
	</select>
	
	<select id="tsearchpage" resultType="com.updev.board.Board">
		select * from (
		select rownum rn,A.* from(
		select * from board where b_title like '%'||#{keyword}||'%' or b_content like '%'||#{keyword}||'%'
		order by b_group DESC,b_step ASC)A)
		where rn between #{start} and #{end}
	</select>
	
  
</mapper>